<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.mapper.DestinationMapper">
	
	<select id="getMyDestinationByPlanIds"  resultType="DestinationDTO">
		SELECT d.* FROM `destination` d
    	JOIN `plan` p ON d.plan_id = p.plan_id
    	WHERE p.plan_id IN
    <foreach item="planId" collection="planIds" open="(" separator="," close=")">
        #{planId}
    </foreach>
	</select>
	
	<select id="getMyDestCountByPlanIds"  resultType="Long">
		SELECT COUNT(*) FROM `destination` d
    	JOIN `plan` p ON d.plan_id = p.plan_id
    	WHERE p.plan_id IN
    <foreach item="planId" collection="planIds" open="(" separator="," close=")">
        #{planId}
    </foreach>
    	GROUP BY d.plan_id
    	ORDER BY d.plan_id;
	</select>
	
	<select id="getMyfirst"  resultType="DestinationDTO">
		select d.city_kor,d.country_kor,d.plan_id 
		from destination as d join place as p on d.destination_id = p.destination_id 
		where plan_id in (#{planId})
		order by start_time limit 1;
	</select>
	
</mapper>